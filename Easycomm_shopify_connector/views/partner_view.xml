<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Partner Form View - Add Shopify Tab -->
    <record id="view_partner_form_shopify" model="ir.ui.view">
        <field name="name">res.partner.form.shopify</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Shopify" name="shopify" invisible="is_shopify_customer == False and shopify_instance_id == False">
                    <group>
                        <group>
                            <field name="is_shopify_customer"/>
                            <field name="shopify_instance_id"/>
                            <field name="shopify_customer_id" readonly="1"/>
                            <field name="shopify_state"/>
                        </group>
                        <group>
                            <field name="shopify_email_verified"/>
                            <field name="shopify_accepts_marketing"/>
                            <field name="shopify_orders_count" readonly="1"/>
                            <field name="shopify_total_spent" readonly="1"/>
                        </group>
                    </group>
                    <group string="Sync Information">
                        <group>
                            <field name="shopify_created_at" readonly="1"/>
                            <field name="shopify_updated_at" readonly="1"/>
                        </group>
                    </group>
                    <div class="oe_chatter">
                        <button name="export_customer_to_shopify"
                                type="object"
                                string="Export to Shopify"
                                class="oe_highlight"
                                invisible="shopify_instance_id == False"/>
                    </div>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Partner List View - Add Shopify Fields -->
    <record id="view_partner_list_shopify" model="ir.ui.view">
        <field name="name">res.partner.list.shopify</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='email']" position="after">
                <field name="is_shopify_customer" optional="hide"/>
                <field name="shopify_customer_id" optional="hide"/>
                <field name="shopify_instance_id" optional="hide"/>
            </xpath>
        </field>
    </record>

    <!-- Partner Search View - Add Shopify Filters -->
    <record id="view_partner_search_shopify" model="ir.ui.view">
        <field name="name">res.partner.search.shopify</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_res_partner_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='inactive']" position="after">
                <separator/>
                <filter string="Shopify Customers" name="shopify_customers" domain="[('is_shopify_customer', '=', True)]"/>
                <filter string="Non-Shopify Customers" name="non_shopify_customers" domain="[('is_shopify_customer', '=', False)]"/>
                <separator/>
                <field name="shopify_instance_id"/>
                <field name="shopify_customer_id"/>
            </xpath>
        </field>
    </record>

    <!-- Shopify Customers Action -->
    <record id="action_shopify_customer" model="ir.actions.act_window">
        <field name="name">Shopify Customers</field>
        <field name="res_model">res.partner</field>
        <field name="view_mode">list,form,kanban</field>
        <field name="domain">[('is_shopify_customer', '=', True)]</field>
        <field name="context">{'search_default_shopify_customers': 1}</field>
    </record>

</odoo>
