<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Product Template Form View - Add Shopify Tab -->
    <record id="product_template_form_view_shopify" model="ir.ui.view">
        <field name="name">product.template.form.shopify</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_only_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='general_information']" position="after">
                <page string="Shopify" name="shopify" invisible="is_shopify_product == False and shopify_instance_id == False">
                    <group>
                        <group>
                            <field name="is_shopify_product"/>
                            <field name="shopify_instance_id"/>
                            <field name="shopify_product_id" readonly="1"/>
                            <field name="shopify_product_status"/>
                        </group>
                        <group>
                            <field name="shopify_product_type"/>
                            <field name="shopify_vendor"/>
                            <field name="shopify_tags"/>
                            <field name="shopify_published_at" readonly="1"/>
                        </group>
                    </group>
                    <group string="Sync Information">
                        <group>
                            <field name="shopify_created_at" readonly="1"/>
                            <field name="shopify_updated_at" readonly="1"/>
                        </group>
                    </group>
                    <div class="oe_chatter">
                        <button name="export_product_to_shopify"
                                type="object"
                                string="Export to Shopify"
                                class="oe_highlight"
                                invisible="shopify_instance_id == False"/>
                    </div>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Product Template List View - Add Shopify Fields -->
    <record id="product_template_list_view_shopify" model="ir.ui.view">
        <field name="name">product.template.list.shopify</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_tree_view"/>
        <field name="arch" type="xml">
            <!-- Add product image column at the beginning -->
            <xpath expr="//field[@name='name']" position="before">
                <field name="image_128" widget="image" options="{'size': [40, 40]}" string="Image"/>
            </xpath>
            <xpath expr="//field[@name='default_code']" position="after">
                <field name="is_shopify_product" optional="hide"/>
                <field name="shopify_product_id" optional="hide"/>
                <field name="shopify_instance_id" optional="hide"/>
            </xpath>
        </field>
    </record>

    <!-- Product Template Search View - Add Shopify Filters -->
    <record id="product_template_search_view_shopify" model="ir.ui.view">
        <field name="name">product.template.search.shopify</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_search_view"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='inactive']" position="after">
                <separator/>
                <filter string="Shopify Products" name="shopify_products" domain="[('is_shopify_product', '=', True)]"/>
                <filter string="Non-Shopify Products" name="non_shopify_products" domain="[('is_shopify_product', '=', False)]"/>
                <separator/>
                <field name="shopify_instance_id"/>
                <field name="shopify_product_id"/>
            </xpath>
        </field>
    </record>

    <!-- Shopify Products Action -->
    <record id="action_product_template_shopify" model="ir.actions.act_window">
        <field name="name">Shopify Products</field>
        <field name="res_model">product.template</field>
        <field name="view_mode">list,form,kanban</field>
        <field name="domain">[('is_shopify_product', '=', True)]</field>
        <field name="context">{'search_default_shopify_products': 1}</field>
    </record>

</odoo>
